{% extends 'base.html' %}
{% load static %}

{% block title %}ê²€ìƒ‰ ê²°ê³¼{% endblock %}

{% block content %}
<div class="container mt-5">
    <!-- í—¤ë” í…ìŠ¤íŠ¸ì™€ ê²€ìƒ‰ì°½ì„ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ë°°ì¹˜ -->
    <div class="header-container d-flex justify-content-between align-items-center">
        <div class="header-text">
            <span class="search-result-title">"{{ query }}"ì— ëŒ€í•œ ê²€ìƒ‰ê²°ê³¼</span>
        </div>
        <!-- ê²€ìƒ‰ì°½ -->
        <div class="search-container">
            <form method="get" action="{% url 'places:search_results' %}" class="m-search">
                <div class="input-container">
                    <input type="text" name="query" class="form-control" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                    <button type="submit" class="btn btn-primary mt-2">
                        <img src="{% static 'images/ê²€ìƒ‰ë²„íŠ¼.png' %}" alt="ê²€ìƒ‰ ë²„íŠ¼" id="searchButton">
                    </button>
                </div>
            </form>
        </div>
    </div>

    

    <hr>

    <!-- ì¶•ì œ ê²€ìƒ‰ ê²°ê³¼ -->
    {% if festivals %}
        <div class="d-flex justify-content-between align-items-center">
            <h3>ğŸ“… ì¶•ì œ</h3>
            <span class="post-count">ì´ {{ festivals|length }}ê±´</span>
        </div>
        <div class="main-grid">
            {% for festival in festivals %}
            <div class="grid-item">
                <div class="image-container">
                    {% if festival.image %}
                        <img src="{{ festival.image.url }}" alt="{{ festival.name }}">
                    {% else %}
                        <div class="image-placeholder">ì´ë¯¸ì§€ ì—†ìŒ</div>
                    {% endif %}
                </div>
                <div class="text-content">
                    <!-- ì¶•ì œ ì œëª© -->
                    <h5>{{ festival.name }}</h5>
                    <!-- ì‘ì„±ìì™€ ì‘ì„±ì¼ -->
                    <p class="post-meta">
                        ì‘ì„±ì: {{ festival.author.username }} | ì‘ì„±ì¼: {{ festival.created_at|date:"Y-m-d H:i" }}
                    </p>
                    <!-- ì°œ ì—¬ë¶€ í‘œì‹œ -->
                    {% if festival.id in user_bookmarks %}
                        <p class="text-success">â˜… ë‚´ê°€ ì°œí•œ ì¶•ì œ</p>
                    {% else %}
                        <p class="text-muted">â˜† ì°œí•˜ì§€ ì•ŠìŒ</p>
                    {% endif %}
                    <!-- ë³„ì  í‘œì‹œ -->
                    <p>ë³„ì : 
                        {% for i in "123" %}
                            <span class="{% if i <= festival.rating|stringformat:"i" %}text-warning{% else %}text-muted{% endif %}">â˜…</span>
                        {% endfor %}
                    </p>
                    <!-- ì¶•ì œ ì„¤ëª… -->
                    <p>{{ festival.description|truncatewords:20 }}</p>
                </div>

                <!-- ë¶ë§ˆí¬ ë²„íŠ¼ -->
                <div class="like-section">
                    <img src="{% static 'images/ë¶ë§ˆí¬-ë¹„ì›Œì§.png' %}" 
                        class="like-btn" 
                        alt="ì°œí•˜ê¸°" 
                        data-id="{{ festival.id }}"
                        data-bookmarked="{% if festival.id in user_bookmarks %}true{% else %}false{% endif %}">
                </div>
            </div>
            {% endfor %}
        </div>
        <hr>
    {% endif %}




    <!-- ì—¬í–‰ì§€ ê²€ìƒ‰ ê²°ê³¼ -->
{% if destinations %}
<div class="d-flex justify-content-between align-items-center">
    <h3>ğŸ—ºï¸ ì—¬í–‰ì§€</h3>
    <span class="post-count">ì´ {{ destinations|length }}ê±´</span>
</div>
<div class="main-grid">
    {% for destination in destinations %}
    <div class="grid-item">
        <div class="image-container">
            {% if destination.image %}
                <img src="{{ destination.image.url }}" alt="{{ destination.name }}">
            {% else %}
                <div class="image-placeholder">ì´ë¯¸ì§€ ì—†ìŒ</div>
            {% endif %}
        </div>
        <div class="text-content">
            <!-- ì—¬í–‰ì§€ ì œëª© -->
            <h5>{{ destination.name }}</h5>
            <!-- ì‘ì„±ìì™€ ì‘ì„±ì¼ -->
            <p class="post-meta">
                ì‘ì„±ì: {{ destination.author.username }} | ì‘ì„±ì¼: {{ destination.created_at|date:"Y-m-d H:i" }}
            </p>
            <!-- ì°œ ì—¬ë¶€ í‘œì‹œ -->
            {% if destination.id in user_bookmarks %}
                <p class="text-success">â˜… ë‚´ê°€ ì°œí•œ ì—¬í–‰ì§€</p>
            {% else %}
                <p class="text-muted">â˜† ì°œí•˜ì§€ ì•ŠìŒ</p>
            {% endif %}
            <!-- ë³„ì  í‘œì‹œ -->
            <p>ë³„ì : 
                {% for i in "123" %}
                    <span class="{% if i <= destination.rating|stringformat:"i" %}text-warning{% else %}text-muted{% endif %}">â˜…</span>
                {% endfor %}
            </p>
            <!-- ì—¬í–‰ì§€ ì„¤ëª… -->
            <p>{{ destination.description|truncatewords:20 }}</p>
        </div>

        <!-- ë¶ë§ˆí¬ ë²„íŠ¼ -->
        <div class="like-section">
            <img src="{% static 'images/ë¶ë§ˆí¬-ë¹„ì›Œì§.png' %}" 
                class="like-btn" 
                alt="ì°œí•˜ê¸°" 
                data-id="{{ destination.id }}"
                data-bookmarked="{% if destination.id in user_bookmarks %}true{% else %}false{% endif %}">
        </div>
    </div>
    {% endfor %}
</div>
<hr>
{% endif %}



    <!-- ë‚¨ì˜ ì—¬í–‰ì¼ì§€ ê²€ìƒ‰ ê²°ê³¼ -->
{% if others_posts %}
<div class="d-flex justify-content-between align-items-center">
    <h3>ğŸ“– ë‚¨ì˜ ì—¬í–‰ì¼ì§€</h3>
    <span class="post-count">ì´ {{ others_posts|length }}ê±´</span>
</div>
<div class="main-grid">
    {% for post in others_posts %}
    <div class="grid-item">
        <div class="image-container">
            {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.title }}">
            {% else %}
                <div class="image-placeholder">ì´ë¯¸ì§€ ì—†ìŒ</div>
            {% endif %}
        </div>
        <div class="text-content">
            <!-- ê²Œì‹œê¸€ ì œëª© -->
            <h5>{{ post.title }}</h5>
            <!-- ì‘ì„±ìì™€ ì‘ì„±ì¼ -->
            <p class="post-meta">
                ì‘ì„±ì: {{ post.author.username }} | ì‘ì„±ì¼: {{ post.created_at|date:"Y-m-d H:i" }}
            </p>
            <!-- ì°œ ì—¬ë¶€ í‘œì‹œ -->
            {% if post.id in user_bookmarks %}
                <p class="text-success">â˜… ë‚´ê°€ ì°œí•œ ê²Œì‹œê¸€</p>
            {% else %}
                <p class="text-muted">â˜† ì°œí•˜ì§€ ì•ŠìŒ</p>
            {% endif %}
            <!-- ë³„ì  í‘œì‹œ -->
            <p>ë³„ì : 
                {% for i in "123" %}
                    <span class="{% if i <= post.rating|stringformat:"i" %}text-warning{% else %}text-muted{% endif %}">â˜…</span>
                {% endfor %}
            </p>
        </div>

        <!-- ë¶ë§ˆí¬ ë²„íŠ¼ -->
        <div class="like-section">
            <img src="{% static 'images/ë¶ë§ˆí¬-ë¹„ì›Œì§.png' %}" 
                class="like-btn" 
                alt="ì°œí•˜ê¸°" 
                data-id="{{ post.id }}"
                data-bookmarked="{% if post.id in user_bookmarks %}true{% else %}false{% endif %}">
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}


   <!-- ì¹œêµ¬ì˜ ì—¬í–‰ì¼ì§€ ê²€ìƒ‰ ê²°ê³¼ -->
{% if friends_posts %}
<div class="d-flex justify-content-between align-items-center">
    <h3>ğŸ‘¥ ì¹œêµ¬ì˜ ì—¬í–‰ì¼ì§€</h3>
    <span class="post-count">ì´ {{ friends_posts|length }}ê±´</span>
</div>
<div class="main-grid">
    {% for post in friends_posts %}
    <div class="grid-item">
        <div class="image-container">
            {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.title }}">
            {% else %}
                <div class="image-placeholder">ì´ë¯¸ì§€ ì—†ìŒ</div>
            {% endif %}
        </div>
        <div class="text-content">
            <!-- ê²Œì‹œê¸€ ì œëª© -->
            <h5>{{ post.title }}</h5>
            <!-- ê²Œì‹œê¸€ ë‚´ìš© (30ë‹¨ì–´ë¡œ ì¶•ì†Œ) -->
            <p>{{ post.content|truncatewords:30 }}</p>
            <!-- ì‘ì„±ì ë° ì‘ì„±ì¼ -->
            <p class="post-meta">
                ì‘ì„±ì: {{ post.author.username }} | ì‘ì„±ì¼: {{ post.created_at|date:"Y-m-d H:i" }}
            </p>
            <!-- ì°œ ì—¬ë¶€ í‘œì‹œ -->
            {% if post.id in user_bookmarks %}
                <p class="text-success">â˜… ë‚´ê°€ ì°œí•œ ê²Œì‹œê¸€</p>
            {% else %}
                <p class="text-muted">â˜† ì°œí•˜ì§€ ì•ŠìŒ</p>
            {% endif %}
            <!-- ë³„ì  í‘œì‹œ -->
            <p>ë³„ì : 
                {% for i in "123" %}
                    <span class="{% if i <= post.rating|stringformat:"i" %}text-warning{% else %}text-muted{% endif %}">â˜…</span>
                {% endfor %}
            </p>
        </div>

        <!-- ë¶ë§ˆí¬ ë²„íŠ¼ -->
        <div class="like-section">
            <img src="{% static 'images/ë¶ë§ˆí¬-ë¹„ì›Œì§.png' %}" 
                 class="like-btn" 
                 alt="ì°œí•˜ê¸°" 
                 data-id="{{ post.id }}"
                 data-bookmarked="{% if post.id in user_bookmarks %}true{% else %}false{% endif %}">
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}


</div>

<!--ìŠ¤íƒ€ì¼-->
<style>
    /* í—¤ë” í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 10px 0;
    }

    .header-text {
        font-size: 37px;
        font-weight: bold;
        color: #508344;
    }

    /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
    .search-container {
        flex-shrink: 0;
    }

    .m-search {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }


    .input-container {
        position: relative; /* ë¶€ëª¨ ì»¨í…Œì´ë„ˆë¡œ ìœ„ì¹˜ë¥¼ ì„¤ì • */
        width: 300px;
    }

    form input[type="text"] {
        width: 300px;
        padding: 10px 40px 10px 10px;
        font-size: 16px;
        border: 2px solid #508344;
        border-radius: 30px;
        box-sizing: border-box;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    

    #searchButton {
        position: absolute;
        top: 10px;
        right: 10%;
        width: 30px;
        height: 30px;
        cursor: pointer;
    }

    /* ì •ë ¬ ê¸°ì¤€ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ */
    form select {
        margin-top: 15px;
    }

    .main-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 30px;
        padding: 30px;
    }

    .grid-item {
        background-color: rgba(239, 236, 236, 0.551);
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        overflow: hidden;
        position: relative;
        cursor: pointer;
    }

    .grid-item img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 8px;
    }

    .grid-item .image-container {
        width: 100%;
        height: 75%;
        overflow: hidden;
        border-radius: 10px 10px 0 0;
        background-color: #d9d9d9;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .grid-item .text-content h5 {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin: 0;
    }

    .grid-item .text-content .post-meta {
        font-size: 14px;
        color: #8b8b8b;
        margin-top: 5px;
    }

    .grid-item .text-content p {
        font-size: 14px;
        margin-top: 10px;
    }

    /* ì„¹ì…˜ í—¤ë” */
    .section-header {
        font-size: 26px;
        font-weight: bold;
        color: #4CAF50;
    }

    .image-placeholder {
        width: 100%;
        height: 100%;
        background-color: #d9d9d9;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #808080;
        font-size: 20px;
    }

    .post-count {
        font-size: 16px;
        color: #808080;
    }

    /* ë¶ë§ˆí¬ ë²„íŠ¼ */
    .like-section {
        position: absolute;
        bottom: 10px; /* í•˜ë‹¨ ìœ„ì¹˜ */
        right: 10px; /* ìš°ì¸¡ ìœ„ì¹˜ */
        z-index: 10;  /* ë‹¤ë¥¸ ì½˜í…ì¸  ìœ„ë¡œ */
    }

    .like-section img {
        width: 35px;  /* ë²„íŠ¼ í¬ê¸° */
        height: 35px;
        object-fit: contain;
    }

    /* ë°°ê²½ ê³ ì • */
    body {
        background-attachment: fixed;
    }
</style>

{% endblock %}
